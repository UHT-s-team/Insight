<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.UHT.Insight.dao.GameTouserDao">
    <!--查询所有-->
    <select id="findAll" resultType="com.UHT.Insight.pojo.GameTouser">
        select * from gametouser
    </select>
    <!--根据Id查询-->
    <select id="findGameTouserById" parameterType="integer">
        select * from gametouser where D_ID=#{D_ID}
    </select>
    <!-- 插入-->
    <insert id="saveGameTouser" parameterType="com.UHT.Insight.pojo.GameTouser">
        insert into gametouser(D_ID,U_ID,G_ID,U_NAME,I_TIME,D_START,G_TIME,D_CONTENT,G_EQUTPTMENT,D_HAPPY,D_AGRESS,D_DISAGRESS,REPLY)
        values (#{D_ID},#{U_ID},#{G_ID},#{U_NAME},#{I_TIME},#{D_START},#{G_TIME},#{D_CONTENT},#{G_EQUTPTMENT},#{D_HAPPY},#{D_AGRESS},#{D_DISAGRESS},#{REPLY})
    </insert>
    <!--更新-->
    <update id="updateGameTouser" parameterType="com.UHT.Insight.pojo.GameTouser">
        update gametouser
        set U_ID=#{U_ID},G_ID=#{G_ID},U_NAME=#{U_NAME},I_TIME=#{I_TIME},D_START=#{D_START},G_TIME=#{G_TIME},D_CONTENT=#{D_CONTENT},G_EQUTPTMENT=#{G_EQUTPTMENT},D_HAPPY=#{D_HAPPY},D_AGRESS=#{D_AGRESS},D_DISAGRESS=#{D_DISAGRESS},REPLY=#{REPLY}
        where D_ID=#{D_ID}
    </update>
    <!--删除-->
    <delete id="deleteGameTouser" parameterType="integer">
        delete from gametouser where D_ID=#{D_ID}
    </delete>
    <select id="findCountEverydayAll" resultMap="map">
     SELECT DATE_FORMAT(I_TIME,'%Y-%m-%d') as'I_TIME',COUNT(0) as 'count',AVG(D_START) as 'average' FROM gametouser
     GROUP BY I_TIME
    </select>
    <resultMap id="map" type="com.UHT.Insight.pojo.GameEverydayData">
        <result column="I_TIME" property="time"/>
        <result column="count" property="num"/>
        <result column="average" property="average"/>
    </resultMap>
    <select id="findCountByStar" resultMap="mapStar" parameterType="Float">
     SELECT DATE_FORMAT(I_TIME,'%Y-%m-%d') AS 'time',COUNT(0) AS 'count',D_START AS star FROM gametouser
     WHERE D_START=#{D_START}
     GROUP BY  time
    </select>
    <resultMap id="mapStar" type="com.UHT.Insight.pojo.GameStarLevel">
        <result column="time" property="time"/>
        <result column="count" property="num"/>
        <result column="star" property="star"/>
    </resultMap>
</mapper>